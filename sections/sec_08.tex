\setcounter{subsection}{8-1}
\subsection{The Principle of Recursive Definition}

% Some macros for this section
\newcommand\sumf[1]{\sum_{k=1}^{#1} b_k}
\newcommand\prodf[1]{\prod_{k=1}^{#1} b_k}

\exercise{1}{
  Let $\seqinf{b}$ be an infinite sequence of real numbers.
  The sum $\sumf{n}$ is defined by induction as follows:
  \ali{
    \sumf{n} &= b_1 \condgap \text{for $n=1$,} \\
    \sumf{n} &= \parens{\sumf{n-1}} + b_n \condgap \text{for $n > 1$.}
  }
  Let $A$ be the set of real numbers; choose $\r$ so that Theorem~8.4 applies to define this sum rigorously.
  We sometimes denote the sum $\sumf{n}$ by the symbol $b_1 + b_2 + \cdots + b_n$.
}
\sol{
  \dwhitman

  For a function $f: \intsfin{m} \to A$, define $\r(f) = f(m) + b_{m+1}$.
  For clarity, denote the sum function by $s : \pints \to A$ so that $s(n) = \sumf{n}$.
  Then by Theorem~8.4 there is a unique $s : \pints \to A$ such that
  \ali{
    s(1) &= b_1\,, \\
    s(n) &= \r(s \rest \intsfin{n-1}) \condgap \text{for $n>1$.}
  }
  Then we clearly have that $\sumf{1} = s(1) = b_1$ and
  \gath{
    \sumf{n} = s(n) = \r(s \rest \intsfin{n-1}) = s(n-1) + b_{(n-1)+1} = \sumf{n-1} + b_n
  }
  for $n>1$ as desired.
}

\exercise{2}{
  Let $\seqinf{b}$ be an infinite sequence of real numbers.
  We define the product $\prodf{n}$ by the equations
  \ali{
    \prodf{1} &= b_1 \,, \\
    \prodf{n} &= \parens{\prodf{n-1}} \cdot b_n \condgap \text{for $n > 1$.}
  }
  Use Theorem~8.4 to define the product rigorously.
  We sometimes denote the product $\prodf{n}$ by the symbol $b_1 b_2 \cdots b_n$.
}
\sol{
  \dwhitman

  First, for any function $f : \intsfin{m} \to \reals$, define $\r$ by $\r(f) = f(m) \cdot b_{m+1}$.
  Then, by the recursion theorem (Theorem~8.4), there is a unique function $p: \pints \to \reals$ such that
  \ali{
    p(1) &= b_1 \,, \\
    p(n) &= \r(p \rest \intsfin{n-1}) \condgap \text{for $n > 1$.}
  }
  Then we define $\prodf{n} = p(n)$ so that we have $\prodf{1} = p(1) = b_1$ and
  \gath{
    \prodf{n} = p(n) = \r(p \rest \intsfin{n-1}) = p(n-1) \cdot b_{(n-1)+1} = \parens{\prodf{n-1}} \cdot b_n
  }
  for $n>1$ as desired.
}

\exercise{3}{
  Obtain the definitions of $a^n$ and $n!$ for $n \in \pints$ as special cases of Exercise~8.2.
}
\sol{
  \dwhitman

  Regarding $a^n$, defined the sequence $\seqinf{b}$ by $b_i = a$ for every $i \in \pints$, which we could denote by $(a,a,\ldots)$.
  Then define $a^n = \prodf{n}$ as it is defined in Exercise~8.2, and we claim that this satisfies the inductive definition given in Exercise~4.6 and Example~8.2.
  \qproof{
    First, we clearly have $a^1 = \prodf{1} = b_1 = a$.
    Next, for $n > 1$, we have
    \gath{
*      a^n = \prodf{n} = \parens{\prodf{n-1}} \cdot b_n = a^{n-1} \cdot a \,,
    }
    which shows that the inductive definition is satisfied.
  }

  Since it does not seem to be given in the book thus far, we reiterate the typical inductive definition for $n!$:
  \ali{
    1! &= 1 \,, \\
    n! &= (n-1)! \cdot n \condgap \text{for $n>1$.}
  }
  Now, define the sequence $\seqinf{b}$ by $b_i = i$ for $i \in \pints$.
  We then claim that defining $n! = \prodf{n}$ as defined in Exercise~8.2 satisfies this definition.
  \qproof{
    First, we have $1! = \prodf{1} = b_1 = 1$.
    Then we also have
    \gath{
      n! = \prodf{n} = \parens{\prodf{n-1}} \cdot b_n = (n-1)! \cdot n
    }
    for $n > 1$ so that the definition is clearly satisfied.
  }
}

\exercise{4}{
  The \emph{Fibonacci numbers} of number theory are defined recursively by the formula
  \ali{
    \l_1 &= \l_2 = 1 \,, \\
    \l_n &= \l_{n-1} + \l_{n-2} \condgap \text{for $n>2$.}
  }
  Define them rigorously by use of Theorem~8.4.
}
\sol{
  \dwhitman

  First, note that the Fibonacci numbers are all positive integers.
  So, for any function $f: \intsfin{m} \to \pints$ define
  \gath{
    \r(f) = \begin{cases}
      1 & m = 1 \\
      f(m) + f(m-1) & m > 1 \,,
    \end{cases}
  }
  noting that clearly the range of $\r$ is still $\pints$ since that is the range of $f$.
  Then, by Theorem~8.4, there is a unique function $F : \pints \to \pints$ such that
  \ali{
    F(1) &= 1 \,, \\
    F(n) &= \r(F \rest \intsfin{n-1}) \condgap \text{for $n>1$.}
  }
  We claim that the Fibonacci numbers are $\l_n = F(n)$ for $n \in \pints$.
  \qproof{
    To show that the numbers $\l_n$ satisfy the inductive definition of the Fibonacci numbers, first note that we clearly have $\l_1 = F(1) = 1$.
    We also have that
    \gath{
      \l_2 = F(2) = \r(F \rest \braces{1}) = 1 \,.
    }
    Lastly, for any $n > 2$, clearly $ n > 1$ also and $n - 1 > 1$ so that
    \gath{
      \l_n = F(n) = \r(F \rest \intsfin{n-1}) = F(n-1) + F([n-1]-1) = \l_{n-1} + \l_{n-2} \,,
    }
    which shows that the inductive definition is satisfied.
  }
}

\exercise{5}{
  Show that there is a unique function $h: \pints \to \preals$ satisfying the formula
  \ali{
    h(1) &= 3 \,, \\
    h(i) &= [h(i-1) + 1]^{1/2} \condgap \text{for $i > 1$.}
  }
}
\sol{
  \dwhitman

  \qproof{
    First, for any function $f : \intsfin{m} \to \preals$, define
    \gath{
      \r(f) = [f(m) + 1]^{1/2} \,.
    }
    Consider any $m \in \pints$ and any function $f: \intsfin{m} \to \preals$.
    Since $f(m) \in \preals$, it follows that $f(m) + 1 \in \preals$ also so that $\r(f) = [f(m)+1]^{1/2}$ is defined and is positive.
    Hence $\r$ is a well-defined function with range $\preals$ since $m$ and $f$ were arbitrary.
    It then follows from the principle of recursive definition (Theorem~8.4) that there is a unique function $h : \pints \to \preals$ such that
    \ali{
      h(1) &= 3 \,, \\
      h(n) &= \r(h \rest \intsfin{n-1}) \condgap \text{for $n > 1$.}
    }
    It is easy to see that this $h$ satisfies the required property since $h(1) = 3$ and
    \gath{
      h(i) = \r(h \rest \intsfin{i-1}) = [h(i-1) + 1]^{1/2}
    }
    for $i > 1$ as desired.

    Now we show that such a function is unique.
    Suppose that $g$ and $h$ both satisfy the inductive formula.
    We show by induction that $g(i) = h(i)$ for all $i \in \pints$, from which it clearly follows that $g = h$.
    First, we clearly have $g(1) = 3 = h(1)$.
    Now suppose that $g(i) = h(i)$ for $i \in \pints$.
    Then we have that $i+1 > 1$ so that $g(i+1) = [g(i) + 1]^{1/2} = [h(i) + 1]^{1/2} = h(i+1)$ since $g(i) = h(i)$ and we are taking the positive root.
    This completes the induction.
  }
}

\exercise{6}{
  \eparts{
  \item Show that there is no function $h : \pints \to \preals$ satisfying the formula
    \ali{
      h(1) &= 3 \,, \\
      h(i) &= [h(i-1) - 1]^{1/2} \condgap \text{for $i > 1$.}
    }
    Explain why this example does not violate the principle of recursive definition.
  \item Consider the recursion formula
    \ali{
      h(1) &= 3 \,, \\
      h(i) &= \left.\begin{cases}
        [h(i-1)-1]^{1/2} & \text{if $h(i-1) > 1$} \\
        5 & \text{if $h(i-1) \leq 1$}
      \end{cases}
      \right\}
      \condgap \text{for $i > 1$.}
    }
    Show that there exists a unique function $h: \pints \to \preals$ satisfying this formula.
  }
}
\sol{
  \dwhitman

  (a)
  \qproof{
    Suppose to the contrary that there is such a function $h$.
    Then clearly $h(1) = 3$ and $h(2) = \sqrt{h(1) - 1} = \sqrt{3-1} = \sqrt{2}$.
    Now, since $1 < 2 < 4$, we clearly have $1 < \sqrt{2} < \sqrt{4} = 2$.
    Thus $0 < \sqrt{2} - 1 < 1$ so that $h(3) = \sqrt{h(2) - 1} = \sqrt{\sqrt{2} - 1}$ is defined.
    However, we also have that $0 < h(3) = \sqrt{\sqrt{2}-1} < 1$ since $0 < \sqrt{2} -1  < 1$, and hence $h(3) - 1 < 0$.
    We then have that
    \gath{
      h(4) = \sqrt{h(3) - 1} \\
      [h(4)]^2 = h(3) - 1 < 0 \,,
    }
    which is of course impossible since a square is always non-negative.
    This contradiction shows that such a function $h$ cannot exist.
  }

  Note that this does not ostensibly violate the principle of recursive definition since $h(n)$ is defined only in terms of values of $h$ less than $n$ for $n>1$.
  However, were one to try to show the existence of $h$ rigorously using the principle, one would find that the required function $\r$ would not be well-defined.

  (b)
  \qproof{
    First, for any function $f : \intsfin{m} \to \preals$, define
    \gath{
      \r(f) = \begin{cases}
        [f(m)-1]^{1/2} & f(m) > 1 \\
        5 & f(m) \leq 1 \,.
      \end{cases}
    }
    Consider any $m \in \pints$ and any function $f : \intsfin{m} \to \preals$.
    If $f(m) > 1$ then clearly $f(m) - 1 > 0$ so that $\r(f) = [f(m)-1]^{1/2}$ is defined and positive.
    If $f(m) \leq 1$ then clearly $\r(f) = 5$ is also defined and positive.
    Since $m$ and $f$ were arbitrary, this shows that $\r$ is a well-defined function with range $\preals$.

    It then follows from the principle of recursive definition (Theorem~8.4) that there is a unique function $h: \pints \to \preals$ such that
    \ali{
      h(1) &= 3 \,, \\
      h(n) &= \r(h \rest \intsfin{n-1}) \condgap \text{for $n > 1$.}
    }
    To see that this $h$ satisfies the recursion formula, clearly $h(1) = 3$, and, for $i>1$, we have
    \gath{
      h(i) = \r(h \rest \intsfin{i-1}) = \begin{cases}
        [h(i-1)-1]^{1/2} & h(i-1) > 1 \\
        5 & h(i-1) \leq 1
      \end{cases}
    }
    as desired.

    To show that this function is unique, suppose that $g$ and $h$ both satisfy the recursive formula.
    We show by induction that $g(n) = h(n)$ for all $n \in \pints$ so that clearly $g = h$.
    First, obviously $g(1) = 3 = h(1)$.
    Now suppose that $g(n) = h(n)$ for $n \in \pints$ so that $n+1 > 1$.
    Then, if $g(n) = h(n) > 1$ then we have $g(n+1) = [g(n)-1]^{1/2} = [h(n)-1]^{1/2} = h(n+1)$ since $g(n) = h(n)$ and the roots are taken to be positive.
    Similarly, if $g(n) = h(n) \leq 1$, then $g(n+1) = 5 = h(n+1)$.
    Thus in either case $g(n+1) = h(n+1)$, which completes the induction.
  }
}

\exercise{7}{\
  Prove Theorem~8.4.
}
\sol{
  \dwhitman

  The proof follows the same pattern used to prove $(*)$ at the beginning of the section, which culminates in Theorem~8.3.
  Similar to that approach, two lemmas will be proved first.
  In what follows, $(*)$ refers to the properties defined in the statement of Theorem~8.4.
  
  \begin{lem}\label{lem:recdef:exists}
    Given $n \in \pints$, there exists a function $f: \intsfin{n} \to A$ that satisfies $(*)$ for all $i$ in its domain.
  \end{lem}
  \qproof{
    We show this by induction on $n$.
    First, for $n=1$, clearly the function $f: \braces{1} \to A$ defined by $f(1) = a_0$ satisfies $(*)$.
    Now suppose that $(*)$ holds for some function $f' : \intsfin{n} \to A$ for $n \in \pints$.
    Now define $f: \intsfin{n+1} \to A$ by
    \gath{
      f(i) = \begin{cases}
        f'(i) & i \in \intsfin{n}  \\
        \r(f') & i = n+1
      \end{cases}
    }
    for any $i \in \intsfin{n+1}$.
    Note that $f$ is not defined in terms of itself, but in terms of $f'$ and $\r$.

    First, we clearly have $f' = f \rest \intsfin{n}$ since $f(i) = f'(i)$ for all $i \in \intsfin{n}$.
    Then, clearly $f(1) = f'(1) = a_0$ since $1 \leq n$ and $f'$ satisfies $(*)$.
    Consider any $i \in \intsfin{n+1}$ where $i > 1$.
    Then we have
    \gath{
      f(i) = f'(i) = \r(f' \rest \intsfin{i-1}) = \r(f \rest \intsfin{i-1})
    }
    if $1 < i \leq n$ since $f'$ satisfies $(*)$.
    Lastly, if $i = n+1$, then
    \gath{
      f(i) = \r(f') = \r(f \rest \intsfin{n}) = \r(f \rest \intsfin{i-1})
    }
    again.
    This shows that $f$ satisfies $(*)$, thereby completing the induction.
  }

  \begin{lem}\label{lem:recdef:unique}
    Suppose that $f : \intsfin{n} \to A$ and $g : \intsfin{m} \to C$ both satisfy $(*)$ for all $i$ in their respective domains.
    Then $f(i) = g(i)$ for all $i$ in both domains.
  \end{lem}
  \qproof{
    Suppose that this is not the case and let $i$ be the \emph{smallest} integer (in the domain of both $f$ and $g$) for which $f(i) \neq g(i)$.
    Hence $f(j) = g(j)$ for all $1 \leq j < i$ so that clearly $f \rest \intsfin{i-1} = g \rest \intsfin{i-1}$.
    Now, it cannot be that $i = 1$ since clearly $f(1) = a_0 = g(1)$.
    So then it must be that $1 < i$ so that $f(i) = \r(f \rest \intsfin{i-1})$ and $g(i) = \r(g \rest \intsfin{i-1})$ since they both satisfy $(*)$.
    Since $f \rest \intsfin{i-1} = g \rest \intsfin{i-1}$, we then clearly have
    \gath{
      f(i) = \r(f \rest \intsfin{i-1}) = \r(g \rest \intsfin{i-1}) = g(i)
    }
    in contradiction with the definition of $i$.
    Thus the result must be true as desired.
  }

  \mainprob

  \qproof{
    Lemmas~\ref{lem:recdef:exists} and \ref{lem:recdef:unique} show that there exists a unique function $f_n : \intsfin{n} \to A$ satisfying $(*)$ for every $n \in \pints$.
    We then define $h = \bigcup_{n \in \pints} f_n$ and claim that this is the unique function from $\pints$ to $A$ satisfying $(*)$.

    First we must show that $h$ is a function at all.
    So consider any $i \in \pints$ and suppose that $(i,x)$ and $(i,y)$ are in $h$.
    Then there are $n,m \in \pints$ where $(i,x) \in f_n$ and $(i,y) \in f_m$ since $h = \bigcup_{n \in \pints} f_n$, noting that it must be that $i \leq n$ and $i \leq m$.
    Since $f_n$ and $f_m$ both satisfy $(*)$ and clearly $i$ is in the domain of both, it follows from Lemma~\ref{lem:recdef:unique} that $x = f_n(i) = f_m(i) = y$.
    This shows that $h$ is a function since $(i,x)$ and $(i,y)$ were arbitrary.
    Also, clearly the domain of $h$ is $\pints$ since, for any $i \in \pints$, $i$ is in the domain of $f_i$ and so in the domain of $h$.
    Lastly, clearly the range of $h$ is $A$ since that is the range of all the $f_n$ functions.

    Now we show that $h$ satisfies $(*)$.
    First we have that $1$ is clearly in the domain of $h$ and $f_1$ so that it has to be that $h(1) = f_1(1) = a_0$ since $h$ is a function, $f_1 \ss h$, and $f_1$ satisfies $(*)$.
    Now suppose that $i > 1$.
    Then clearly $i$ is in the domain of $h$ and $f_i$ so that it has to be that $h(j) = f_i(j)$ for $1 \leq j \leq i$ since $h$ was shown to be a function and $f_i \ss h$.
    It then follows that $h \rest \intsfin{i-1} = f_i \rest \intsfin{i-1}$.
    Thus we have
    \gath{
      h(i) = f_i(i) = \r(f_i \rest \intsfin{i-1}) = \r(h \rest \intsfin{i-1})
    }
    since $f_i$ satisfies $(*)$.
    This completes the proof that $h$ also satisfies $(*)$.

    Lastly, we show that $h$ is unique, which is very similar to the proof of Lemma~\ref{lem:recdef:unique}.
    So suppose that $f$ and $g$ are two functions from $\pints$ to $A$ that both satisfy $(*)$.
    Suppose also that $f \neq g$ so that there is a smallest integer $i$ such that $f(i) \neq g(i)$.
    Now, it cannot be that $i = 1$ since we have $f(1) = a_0 = g(1)$ since they both satisfy $(*)$.
    Hence $i > 1$ and, since $i$ is the smallest integer where $f(i) \neq g(i)$, it follows that $f(j) = g(j)$ for all $1 \leq j < i$.
    Therefore we have that $f \rest \intsfin{i-1} = g \rest \intsfin{i-1}$ so that
    \gath{
      f(i) = \r(f \rest \intsfin{i-1}) = \r(g \rest \intsfin{i-1}) = g(i)
    }
    since $f$ and $g$ both satisfy $(*)$ and $i > 1$.
    This of course contradicts the definition of $i$ so that it has to be that in fact $f=g$.
    This shows the uniqueness of $h$ constructed above.
  }
}

\exercise{8}{
  Verify the following version of the principle of recursive definition: Let $A$ be a set.
  Let $\r$ be a function assigning, to every function $f$ mapping a section $S_n$ of $\pints$ into $A$, an element $\r(f)$ of $A$.
  Then there is a unique function $h: \pints \to A$ such that $h(n) = \r(h \rest S_n)$ for each $n \in \pints$.
}
\sol{
  \dwhitman

  Denote the above property of $h$ by $(*)$.
  We show that there is a unique $h: \pints \to A$ satisfying this using the standard principle of recursive definition, Theorem~8.4.
  \qproof{
    First, note that $S_1 = \braces{n \in \pints \where n < 1} = \es$ by definition.
    Note also that $\es$ itself is vacuously a function from $S_1 = \es$ to $A$, and is the only such function.
    It then follows that $f \rest S_1 = f \rest \es = \es$ for any $f : S_n \to A$ for some $n \in \pints$.
    So then, define $a_0 = \r(\es)$ so that there is a unique function $h$ such that
    \ali{
      h(1) &= a_0 \,, \\
      h(i) &= \r(h \rest \intsfin{i-1}) \condgap \text{for $i > 1$.}
    }
    by Theorem~8.4.
    Denote this property by $(+)$.

    We first claim that this $h$ satisfies $(*)$.
    To see this, consider any $n \in \pints$.
    If $n=1$ then we have
    \gath{
      h(n) =  h(1) = a_0 = \r(\es) = \r(h \rest \es) = \r(h \rest S_1) = \r(h \rest S_n) \,.
    }
    If $n > 1$ then by $(+)$ we have
    \gath{
      h(n) = \r(h \rest \intsfin{n-1}) = \r(h \rest S_n)
    }
    again.
    Since $n$ was arbitrary, this shows that $(*)$ is satisfied.

    To show that this $h$ satisfying $(*)$ is unique, suppose that another function $f: \pints \to A$ satisfies $(*)$.
    Then we have
    \gath{
      h(1) = \r(h \rest S_1) = \r(h \rest \es) = \r(\es) = a_0
    }
    and
    \gath{
      h(i) = \r(h \rest S_i) = \r(h \rest \intsfin{i-1})
    }
    for $i > 1$.
    This shows that $f$ also satisfies $(+)$, and, since we know that the function satisfying $(+)$ is unique, it must be that $f = h$ as desired.
  } 
}
